---
title: "R Notebook"
output: html_notebook
---



```{r}
library("readxl")
library(dplyr)
library(tidyr)

```


```{r, loadData}
df_agrar <- read_excel("test1.xlsx")
df_ped <- read_excel("test1.xlsx")
df_info <- read_excel("test1.xlsx")
df_cs <- read_excel("test1.xlsx")



```
```{r, aggregateData}

aggregateData <- function(data){
  data %>% 
    select(-`Wahre Aussage`, -`Falsche Aussage`, -`...12`) %>%
    rename(
      conttextT = `Kontext (0/1)`,
      syntaxT = `Syntax  (0/1)`,
      contextF = `Kontext  (0/1)`,
      sytaxF = `Syntax (0/1)`,        
      specifityF = `Fachliche Einordnung (0/1)`,
      plausebilityF = `PlausibilitÃ¤t (0/1)`,
      logicF = `Logik (0/1)`,
      falsabilityF = `Falschheit (0/1)`,
      difficultyF = `Schwierigkeit (1-10)`
      ) %>%
    replace(is.na(.), 0) %>%
    mutate(difficultyF = difficultyF / 10) %>%
    tidyr::pivot_longer(cols=ends_with("F"), names_to = "variable", values_to = "count") %>%
    select(variable, count) %>%
    group_by(variable) %>%
    summarise(n=sum(count)/(nrow(data)-1)) %>%
    mutate(n=round(n,2))
}

res_agrar <- aggregateData(df_agrar)
res_ped <- aggregateData(df_ped)
res_info <- aggregateData(df_info)
res_cs <- aggregateData(df_cs)
  
```

```{r combinedresults}

res <- cbind(res_agrar, rowOrder=c(1, 7, 6, 5, 4, 3, 2))
#res <- res_agrar
res %>% 
  rename(Agriculture = n) %>%
  right_join(res_cs, by=c('variable')) %>%
  rename(Computer_Science = n) %>%
  right_join(res_info, by=c('variable')) %>%
  rename(Economics = n) %>%
  right_join(res_ped, by=c('variable')) %>%
  rename(Pedagogy = n) %>%
  arrange(rowOrder) %>% 
  select(-rowOrder) %>%
  mutate(Total = (Agriculture + Computer_Scienc + Economics + Pedagogy) / 4)

```

